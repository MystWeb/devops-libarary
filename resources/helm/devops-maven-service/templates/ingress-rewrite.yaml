# 前后端分离的ingress配置
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    meta.helm.sh/release-name: devops-demo-ui
    meta.helm.sh/release-namespace: devops-demo-dev01
  labels:
    app.kubernetes.io/instance: devops-demo-ui
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: devops-demo-ui
    app.kubernetes.io/version: 1.16.0
    helm.sh/chart: devops-demo-ui-0.1.0
  name: devops-demo-ui
  namespace: devops-demo-dev01
spec:
  rules:
    - host: devops.demo.ui.dev01
      http:
        paths:
          - backend:
              service:
                name: devops-demo-ui
                port:
                  number: 80
            path: /
            pathType: ImplementationSpecific
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    #nginx.ingress.kubernetes.io/rewrite-target: /$2
  name: devops-demo-ui-rewrite
  namespace: devops-demo-dev01
spec:
  rules:
    - host: devops.demo.ui.dev01
      http:
        paths:
          - backend:
              service:
                name: devops-demo-service
                port:
                  number: 8080
            #path: /api(/|$)(.*)
            path: /api
            #pathType: Prefix
            pathType: ImplementationSpecific
          - backend:
              service:
                name: devops-demo-service
                port:
                  number: 8080
            #path: /ws-server(/|$)(.*)
            path: /ws-server
            pathType: ImplementationSpecific
